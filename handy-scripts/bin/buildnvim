#!/bin/sh


NVIM_DIR="$HOME/neovim"
BUILD_DIR="$NVIM_DIR/build"
MAKEFILE="$NVIM_DIR/Makefile"
NVIM_TAG="stable"

[ -n "$1" ] && NVIM_TAG="$1"

[ ! -d "$NVIM_DIR" ] && echo "yo dawg, you haven't cloned neovim..!" && exit 1

git -C "$NVIM_DIR" checkout --quiet "$NVIM_TAG"

[ -d /usr/local/share/nvim ] && sudo rm -rf /usr/local/share/nvim
make -C "$NVIM_DIR" distclean

mkdir -p "$BUILD_DIR"
make -C "$NVIM_DIR" -f "$MAKEFILE" CMAKE_BUILD_TYPE=RelWithDebInfo
sudo make -C "$NVIM_DIR" install
